<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>IM: WMV - Windows Media Video Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>WMV - Windows Media Video Format<br/>
<small>
[<a class="el" href="group__format.html">File Formats</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p><div class="dynheader">
Collaboration diagram for WMV - Windows Media Video Format:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__wmv.png" border="0" alt="" usemap="#group____wmv"/>
<map name="group____wmv" id="group____wmv">
<area shape="rect" id="node2" href="group__format.html" title="File Formats" alt="" coords="5,5,117,37"/></map>
</td></tr></table></center>
</div>
</p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__wmv.html#ga47e2ae36cfad528d6a354b6a01d96efb">imFormatRegisterWMV</a> (void)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" id="Description"></a>
Description</h2>
<dl class="user"><dt><b></b></dt><dd>Advanced Systems Format (ASF) <br/>
 Windows Copyright Microsoft Corporation. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Access to the WMV format uses Windows Media SDK. Available in Windows Only. <br/>
 You must link the application with "im_wmv.lib" and you must call the function <a class="el" href="group__wmv.html#ga47e2ae36cfad528d6a354b6a01d96efb">imFormatRegisterWMV</a> once to register the format into the IM core library. In Lua call require"imlua_wmv". <br/>
 Depends also on the WMF SDK (wmvcore.lib). When using the "im_wmv.dll" this extra library is not necessary. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The application users should have the WMV codec 9 installed: <a href="http://www.microsoft.com/windows/windowsmedia/format/codecdownload.aspx">http://www.microsoft.com/windows/windowsmedia/format/codecdownload.aspx</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>You must agree with the WMF SDK EULA to use the SDK. <br/>
 <a href="http://wmlicense.smdisp.net/v9sdk/">http://wmlicense.smdisp.net/v9sdk/</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>For more information: <br/>
 <a href="http://www.microsoft.com/windows/windowsmedia/9series/sdk.aspx">http://www.microsoft.com/windows/windowsmedia/9series/sdk.aspx</a> <br/>
 <a href="http://msdn.microsoft.com/library/en-us/wmform/htm/introducingwindowsmediaformat.asp">http://msdn.microsoft.com/library/en-us/wmform/htm/introducingwindowsmediaformat.asp</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>See <a class="el" href="im__format__wmv_8h.html">im_format_wmv.h</a></dd></dl>
<h2><a class="anchor" id="Features"></a>
Features</h2>
<div class="fragment"><pre class="fragment">
    Data Types: Byte
    Color Spaces: RGB and MAP (Gray and Binary saved as MAP)
    Compressions (installed in Windows XP by default):
      NONE       - no compression
      MPEG-4v3   - Windows Media MPEG-4 Video V3
      MPEG-4v1   - ISO MPEG-4 Video V1
      WMV7       - Windows Media Video  V7
      WMV7Screen - Windows Media Screen V7
      WMV8       - Windows Media Video  V8
      WMV9Screen - Windows Media Video 9 Screen
      WMV9       - Windows Media Video 9 [default]
      Unknown    - Others
    Can have more than one image. 
    Can have an alpha channel (only for RGB) ?
    Internally the components are always packed.
    Lines arranged from top down to bottom or bottom up to top.
    Handle(0) return NULL. imBinFile is not supported.
    Handle(1) returns IWMSyncReader* when reading, IWMWriter* when writing.
 
    Attributes:
      FPS IM_FLOAT (1) (should set when writing, default 15)
      WMFQuality IM_INT (1) [0-100, default 50] (write only)
      MaxKeyFrameTime IM_INT (1) (write only) [maximum key frame interval in miliseconds, default 5 seconds]
      DataRate IM_INT (1) (write only) [kilobits/second, default 2400]
      VBR IM_INT (1) [0, 1] (write only) [0 - Constant Bit Rate (default), 1 - Variable Bit Rate (Quality-Based)]
      (and several others from the file-level attributes) For ex:
        Title, Author, Copyright, Description (string)
        Duration IM_INT [100-nanosecond units]
        Seekable, HasAudio, HasVideo, Is_Protected, Is_Trusted, IsVBR IM_INT (1) [0, 1]
        NumberOfFrames IM_INT (1)

    Comments:
      IMPORTANT - The "image_count" and the "FPS" attribute may not be available from the file,
        we try to estimate from the duration and from the average time between frames, or using the default value.
      We do not handle DRM protected files (Digital Rights Management).
      Reads only the first video stream. Other streams are ignored.
      All the images have the same size, you must call imFileReadImageInfo/imFileWriteImageInfo 
        at least once.
      For optimal random reading, the file should be indexed previously.
      If not indexed by frame, random positioning may not be precise.
      Sequencial reading will always be precise.
      When writing we use a custom profile and time indexing only.
      We do not support multipass encoding.  
      Since the driver uses COM, CoInitialize(NULL) and CoUninitialize() are called every Open/Close.
</pre></div> <hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga47e2ae36cfad528d6a354b6a01d96efb"></a><!-- doxytag: member="im_format_wmv.h::imFormatRegisterWMV" ref="ga47e2ae36cfad528d6a354b6a01d96efb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imFormatRegisterWMV </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Register the WMF Format. <br/>
 In Lua, when using require"imlua_wmv" this function will be automatically called. </p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue May 15 2012 12:06:07 for IM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
